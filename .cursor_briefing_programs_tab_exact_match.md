# Programs Tab - Exact Kotlin Match

**Task:** Implement Flutter Programs Tab (two screens) to exactly match Kotlin implementation

**Source Analysis:** PROGRAMS_TAB_ANALYSIS.md (comprehensive 1000+ line analysis)

## Overview

Programs Tab is a **TWO-SCREEN SYSTEM**:
1. **WeeklyProgramsScreen** - List view of all programs with active program card
2. **ProgramBuilderScreen** - 7-day schedule editor for creating/editing programs

## Current Flutter Implementation Status

### ✅ Likely Already Exist (Verify):
- Domain models: `WeeklyProgram`, `ProgramDay` (check lib/domain/models/)
- Repositories: `ProgramRepository` (check lib/data/)
- Database tables: `weekly_programs`, `program_days` (check Drift schema)

### ❌ Missing or Needs Update:
- `lib/presentation/screens/weekly_programs_screen.dart` - List view (NEW or UPDATE)
- `lib/presentation/screens/program_builder_screen.dart` - Editor (NEW)
- `lib/presentation/widgets/program/program_card.dart` - Program card widget (NEW)
- `lib/presentation/widgets/program/active_program_card.dart` - Active program banner (NEW)
- `lib/presentation/widgets/program/day_assignment_card.dart` - Day routine picker (NEW)
- Helper functions: Today's workout detection, program summary formatting

---

## SCREEN 1: WeeklyProgramsScreen (List View)

**File:** `lib/presentation/screens/weekly_programs_screen.dart`

### Widget Structure

```dart
class WeeklyProgramsScreen extends ConsumerWidget {
  const WeeklyProgramsScreen({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final programs = ref.watch(weeklyProgramsProvider);  // List<WeeklyProgram>
    final activeProgram = programs.firstWhereOrNull((p) => p.isActive);
    final theme = Theme.of(context);
    final isDark = theme.brightness == Brightness.dark;

    return Container(
      decoration: BoxDecoration(
        gradient: LinearGradient(
          begin: Alignment.topCenter,
          end: Alignment.bottomCenter,
          colors: isDark
            ? [
                const Color(0xFF0F172A), // slate-900
                const Color(0xFF1E1B4B), // indigo-950
                const Color(0xFF172554), // blue-950
              ]
            : [
                const Color(0xFFE0E7FF), // indigo-200
                const Color(0xFFFCE7F3), // pink-100
                const Color(0xFFDDD6FE), // violet-200
              ],
        ),
      ),
      child: Scaffold(
        backgroundColor: Colors.transparent,
        body: programs.isEmpty
            ? EmptyState(
                icon: Icons.calendar_month,
                title: 'No programs yet',
                message: 'Create your first weekly workout program',
                actionLabel: 'Create Program',
                onAction: () => _navigateToBuilder(context, ref),
              )
            : Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  // Header
                  Padding(
                    padding: const EdgeInsets.all(20.0),
                    child: Text(
                      'Weekly Programs',
                      style: theme.textTheme.headlineMedium?.copyWith(
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                  ),

                  // Active Program Card (if exists)
                  if (activeProgram != null)
                    ActiveProgramCard(
                      program: activeProgram,
                      onStartWorkout: () => _startTodaysWorkout(context, ref, activeProgram),
                    ),

                  // Program List
                  Expanded(
                    child: ListView.separated(
                      padding: const EdgeInsets.only(bottom: 88), // FAB clearance
                      itemCount: programs.length,
                      separatorBuilder: (_, __) => const SizedBox(height: 8),
                      itemBuilder: (context, index) {
                        return ProgramCard(
                          program: programs[index],
                          onTap: () => _navigateToBuilder(context, ref, program: programs[index]),
                          onActivate: () => _activateProgram(ref, programs[index]),
                          onDelete: () => _deleteProgram(ref, programs[index]),
                        );
                      },
                    ),
                  ),
                ],
              ),
        floatingActionButton: FloatingActionButton.extended(
          onPressed: () => _navigateToBuilder(context, ref),
          icon: const Icon(Icons.add),
          label: const Text('Create Program'),
        ),
      ),
    );
  }
}
```

### Helper Methods

```dart
void _navigateToBuilder(BuildContext context, WidgetRef ref, {WeeklyProgram? program}) {
  context.push(Routes.programBuilder, extra: program);
}

void _activateProgram(WidgetRef ref, WeeklyProgram program) async {
  // Deactivate all, then activate selected
  await ref.read(weeklyProgramsProvider.notifier).deactivateAll();
  await ref.read(weeklyProgramsProvider.notifier).activateProgram(program.id);
}

void _deleteProgram(WidgetRef ref, WeeklyProgram program) {
  ref.read(weeklyProgramsProvider.notifier).deleteProgram(program.id);
}

void _startTodaysWorkout(BuildContext context, WidgetRef ref, WeeklyProgram program) {
  final today = DateTime.now().weekday; // 1=Monday, 7=Sunday
  final todayRoutine = program.days.firstWhereOrNull((d) => d.dayOfWeek == today);

  if (todayRoutine?.routineId != null) {
    // Navigate to ActiveWorkoutScreen with routine
    // TODO: Implement navigation
  }
}
```

---

## SCREEN 2: ProgramBuilderScreen (7-Day Editor)

**File:** `lib/presentation/screens/program_builder_screen.dart`

### Widget Structure

```dart
class ProgramBuilderScreen extends ConsumerStatefulWidget {
  final WeeklyProgram? existingProgram;

  const ProgramBuilderScreen({super.key, this.existingProgram});

  @override
  ConsumerState<ProgramBuilderScreen> createState() => _ProgramBuilderScreenState();
}

class _ProgramBuilderScreenState extends ConsumerState<ProgramBuilderScreen> {
  late TextEditingController _nameController;
  late Map<int, String?> _dayAssignments;  // dayOfWeek (1-7) -> routineId

  @override
  void initState() {
    super.initState();
    _nameController = TextEditingController(
      text: widget.existingProgram?.name ?? '',
    );
    _dayAssignments = {
      1: null, 2: null, 3: null, 4: null, 5: null, 6: null, 7: null,
    };

    // Load existing assignments
    if (widget.existingProgram != null) {
      for (final day in widget.existingProgram!.days) {
        _dayAssignments[day.dayOfWeek] = day.routineId;
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);
    final isDark = theme.brightness == Brightness.dark;

    return Container(
      decoration: BoxDecoration(
        gradient: LinearGradient(
          begin: Alignment.topCenter,
          end: Alignment.bottomCenter,
          colors: isDark
            ? [
                const Color(0xFF0F172A), // slate-900
                const Color(0xFF1E1B4B), // indigo-950
                const Color(0xFF172554), // blue-950
              ]
            : [
                const Color(0xFFE0E7FF), // indigo-200
                const Color(0xFFFCE7F3), // pink-100
                const Color(0xFFDDD6FE), // violet-200
              ],
        ),
      ),
      child: Scaffold(
        backgroundColor: Colors.transparent,
        appBar: AppBar(
          title: Text(widget.existingProgram == null ? 'Create Program' : 'Edit Program'),
          backgroundColor: Colors.transparent,
          elevation: 0,
          actions: [
            TextButton(
              onPressed: _canSave ? _saveProgram : null,
              child: Text(
                'Save',
                style: TextStyle(
                  color: _canSave ? theme.colorScheme.primary : theme.disabledColor,
                  fontWeight: FontWeight.bold,
                ),
              ),
            ),
          ],
        ),
        body: Column(
          children: [
            // Program Name Input
            Padding(
              padding: const EdgeInsets.all(20),
              child: TextField(
                controller: _nameController,
                decoration: const InputDecoration(
                  labelText: 'Program Name',
                  border: OutlineInputBorder(),
                ),
                onChanged: (_) => setState(() {}),
              ),
            ),

            // 7-Day Assignment List
            Expanded(
              child: ListView.separated(
                padding: const EdgeInsets.symmetric(horizontal: 20),
                itemCount: 7,
                separatorBuilder: (_, __) => const SizedBox(height: 8),
                itemBuilder: (context, index) {
                  final dayOfWeek = index + 1;  // 1=Monday, 7=Sunday
                  return DayAssignmentCard(
                    dayOfWeek: dayOfWeek,
                    selectedRoutineId: _dayAssignments[dayOfWeek],
                    onRoutineSelected: (routineId) {
                      setState(() {
                        _dayAssignments[dayOfWeek] = routineId;
                      });
                    },
                  );
                },
              ),
            ),
          ],
        ),
      ),
    );
  }

  bool get _canSave => _nameController.text.trim().isNotEmpty;

  void _saveProgram() async {
    final name = _nameController.text.trim();

    final program = WeeklyProgram(
      id: widget.existingProgram?.id ?? Uuid().v4(),
      name: name,
      isActive: widget.existingProgram?.isActive ?? false,
      createdAt: widget.existingProgram?.createdAt ?? DateTime.now(),
      lastUsed: DateTime.now(),
      days: _dayAssignments.entries
          .where((e) => e.value != null)
          .map((e) => ProgramDay(
                id: Uuid().v4(),
                programId: widget.existingProgram?.id ?? '',  // Will be set after insert
                dayOfWeek: e.key,
                routineId: e.value!,
              ))
          .toList(),
    );

    if (widget.existingProgram == null) {
      await ref.read(weeklyProgramsProvider.notifier).createProgram(program);
    } else {
      await ref.read(weeklyProgramsProvider.notifier).updateProgram(program);
    }

    if (mounted) {
      context.pop();
    }
  }
}
```

---

## Widget 1: ProgramCard

**File:** `lib/presentation/widgets/program/program_card.dart` (NEW)

### Implementation

```dart
class ProgramCard extends StatelessWidget {
  final WeeklyProgram program;
  final VoidCallback onTap;
  final VoidCallback onActivate;
  final VoidCallback onDelete;

  const ProgramCard({
    super.key,
    required this.program,
    required this.onTap,
    required this.onActivate,
    required this.onDelete,
  });

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);

    return Padding(
      padding: const EdgeInsets.symmetric(horizontal: 20),
      child: Card(
        elevation: 4,
        surfaceTintColor: Colors.transparent,
        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
        child: InkWell(
          onTap: onTap,
          borderRadius: BorderRadius.circular(12),
          child: Padding(
            padding: const EdgeInsets.all(16),
            child: Row(
              children: [
                // Content Column
                Expanded(
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      // Program Name + Active Badge
                      Row(
                        children: [
                          Expanded(
                            child: Text(
                              program.name,
                              style: theme.textTheme.titleLarge?.copyWith(
                                fontWeight: FontWeight.bold,
                              ),
                              maxLines: 1,
                              overflow: TextOverflow.ellipsis,
                            ),
                          ),
                          if (program.isActive) ...[
                            const SizedBox(width: 8),
                            Container(
                              padding: const EdgeInsets.symmetric(
                                horizontal: 8,
                                vertical: 4,
                              ),
                              decoration: BoxDecoration(
                                color: theme.colorScheme.primaryContainer,
                                borderRadius: BorderRadius.circular(12),
                              ),
                              child: Text(
                                'Active',
                                style: theme.textTheme.labelSmall?.copyWith(
                                  color: theme.colorScheme.onPrimaryContainer,
                                  fontWeight: FontWeight.bold,
                                ),
                              ),
                            ),
                          ],
                        ],
                      ),

                      const SizedBox(height: 8),

                      // Summary
                      Text(
                        _formatSummary(program.days),
                        style: theme.textTheme.bodyMedium?.copyWith(
                          color: theme.colorScheme.onSurfaceVariant,
                        ),
                      ),
                    ],
                  ),
                ),

                const SizedBox(width: 8),

                // Overflow Menu
                PopupMenuButton<String>(
                  icon: const Icon(Icons.more_vert),
                  onSelected: (value) {
                    switch (value) {
                      case 'activate':
                        onActivate();
                        break;
                      case 'delete':
                        onDelete();
                        break;
                    }
                  },
                  itemBuilder: (context) => [
                    if (!program.isActive)
                      const PopupMenuItem(
                        value: 'activate',
                        child: Row(
                          children: [
                            Icon(Icons.check_circle, size: 20),
                            SizedBox(width: 12),
                            Text('Activate'),
                          ],
                        ),
                      ),
                    const PopupMenuItem(
                      value: 'delete',
                      child: Row(
                        children: [
                          Icon(Icons.delete, size: 20),
                          SizedBox(width: 12),
                          Text('Delete'),
                        ],
                      ),
                    ),
                  ],
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }

  String _formatSummary(List<ProgramDay> days) {
    if (days.isEmpty) return 'No days assigned';

    final count = days.length;
    return '$count day${count == 1 ? '' : 's'} per week';
  }
}
```

---

## Widget 2: ActiveProgramCard

**File:** `lib/presentation/widgets/program/active_program_card.dart` (NEW)

### Implementation

```dart
class ActiveProgramCard extends ConsumerWidget {
  final WeeklyProgram program;
  final VoidCallback onStartWorkout;

  const ActiveProgramCard({
    super.key,
    required this.program,
    required this.onStartWorkout,
  });

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final theme = Theme.of(context);
    final today = DateTime.now().weekday;  // 1=Monday, 7=Sunday
    final todayRoutine = program.days.firstWhereOrNull((d) => d.dayOfWeek == today);

    return Padding(
      padding: const EdgeInsets.fromLTRB(20, 0, 20, 16),
      child: Card(
        elevation: 4,
        color: theme.colorScheme.primaryContainer,
        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              // Active Program Label
              Text(
                'Active Program',
                style: theme.textTheme.labelMedium?.copyWith(
                  color: theme.colorScheme.onPrimaryContainer,
                  fontWeight: FontWeight.bold,
                ),
              ),

              const SizedBox(height: 4),

              // Program Name
              Text(
                program.name,
                style: theme.textTheme.titleLarge?.copyWith(
                  fontWeight: FontWeight.bold,
                  color: theme.colorScheme.onPrimaryContainer,
                ),
              ),

              const SizedBox(height: 12),

              // Today's Workout Info
              if (todayRoutine != null) ...[
                Text(
                  'Today: ${_getDayName(today)}',
                  style: theme.textTheme.bodyMedium?.copyWith(
                    color: theme.colorScheme.onPrimaryContainer.withOpacity(0.8),
                  ),
                ),
                const SizedBox(height: 12),
                SizedBox(
                  width: double.infinity,
                  child: FilledButton.icon(
                    onPressed: onStartWorkout,
                    icon: const Icon(Icons.play_arrow),
                    label: const Text('Start Today\'s Workout'),
                  ),
                ),
              ] else ...[
                Text(
                  'Today: Rest day',
                  style: theme.textTheme.bodyMedium?.copyWith(
                    color: theme.colorScheme.onPrimaryContainer.withOpacity(0.8),
                  ),
                ),
              ],
            ],
          ),
        ),
      ),
    );
  }

  String _getDayName(int dayOfWeek) {
    const days = ['', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
    return days[dayOfWeek];
  }
}
```

---

## Widget 3: DayAssignmentCard

**File:** `lib/presentation/widgets/program/day_assignment_card.dart` (NEW)

### Implementation

```dart
class DayAssignmentCard extends ConsumerWidget {
  final int dayOfWeek;  // 1=Monday, 7=Sunday
  final String? selectedRoutineId;
  final ValueChanged<String?> onRoutineSelected;

  const DayAssignmentCard({
    super.key,
    required this.dayOfWeek,
    this.selectedRoutineId,
    required this.onRoutineSelected,
  });

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final routines = ref.watch(routinesProvider);  // All available routines
    final selectedRoutine = routines.firstWhereOrNull((r) => r.id == selectedRoutineId);
    final theme = Theme.of(context);

    return Card(
      elevation: 2,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
      child: Padding(
        padding: const EdgeInsets.all(16),
        child: Row(
          children: [
            // Day Name
            SizedBox(
              width: 100,
              child: Text(
                _getDayName(dayOfWeek),
                style: theme.textTheme.titleMedium?.copyWith(
                  fontWeight: FontWeight.bold,
                ),
              ),
            ),

            const SizedBox(width: 16),

            // Routine Dropdown
            Expanded(
              child: DropdownButtonFormField<String?>(
                value: selectedRoutineId,
                decoration: const InputDecoration(
                  labelText: 'Routine',
                  border: OutlineInputBorder(),
                  contentPadding: EdgeInsets.symmetric(horizontal: 12, vertical: 8),
                ),
                items: [
                  const DropdownMenuItem(
                    value: null,
                    child: Text('Rest day'),
                  ),
                  ...routines.map((r) => DropdownMenuItem(
                    value: r.id,
                    child: Text(r.name),
                  )),
                ],
                onChanged: onRoutineSelected,
              ),
            ),
          ],
        ),
      ),
    );
  }

  String _getDayName(int dayOfWeek) {
    const days = ['', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
    return days[dayOfWeek];
  }
}
```

---

## Critical Implementation Notes

### 1. Day of Week Mapping (CRITICAL)
```dart
// Kotlin: DayOfWeek.value = 1 (Monday) to 7 (Sunday)
// Dart: DateTime.weekday = 1 (Monday) to 7 (Sunday)
// ✅ EXACT MATCH - Use DateTime.weekday directly for database storage
final today = DateTime.now().weekday;  // 1-7
```

### 2. Active Program Logic (CRITICAL)
- **Only ONE program can be active at a time**
- When activating: Deactivate ALL first, then activate selected
```dart
await ref.read(weeklyProgramsProvider.notifier).deactivateAll();
await ref.read(weeklyProgramsProvider.notifier).activateProgram(programId);
```

### 3. Today's Workout Detection
```dart
final today = DateTime.now().weekday;
final todayRoutine = program.days.firstWhereOrNull((d) => d.dayOfWeek == today);

if (todayRoutine?.routineId != null) {
  // Show "Start Today's Workout" button
} else {
  // Show "Rest day"
}
```

### 4. Program Summary Formatting
```dart
String _formatSummary(List<ProgramDay> days) {
  if (days.isEmpty) return 'No days assigned';
  final count = days.length;
  return '$count day${count == 1 ? '' : 's'} per week';
}
```

### 5. Simpler Styling (vs Routines Tab)
- **NO spring press animation** (unlike RoutinesTab)
- **NO gradient icon boxes** (text-only list)
- **Simple InkWell** (Material ripple only)
- Same card styling: 4dp elevation, 12dp radius, 16dp padding

### 6. Active Badge
```dart
Container(
  padding: EdgeInsets.symmetric(horizontal: 8, vertical: 4),
  decoration: BoxDecoration(
    color: theme.colorScheme.primaryContainer,
    borderRadius: BorderRadius.circular(12),
  ),
  child: Text('Active', style: labelSmall.bold),
)
```

### 7. Overflow Menu (Conditional)
- If program is active: Show ONLY "Delete"
- If program is inactive: Show "Activate" and "Delete"

---

## Implementation Checklist

### Domain & Data
- [ ] Verify `WeeklyProgram` model exists with all required fields
- [ ] Verify `ProgramDay` model exists (programId, dayOfWeek 1-7, routineId)
- [ ] Verify `ProgramRepository` exists with CRUD methods
- [ ] Verify Drift tables: `weekly_programs`, `program_days`
- [ ] Add `uuid` package if not present

### Screen 1: WeeklyProgramsScreen
- [ ] Create or update `weekly_programs_screen.dart` with gradient background
- [ ] Implement conditional rendering (empty state vs list)
- [ ] Add screen header "Weekly Programs" (headlineMedium, Bold, 20dp padding)
- [ ] Implement ActiveProgramCard at top (if active program exists)
- [ ] Create program list with 8dp spacing
- [ ] Add FAB "Create Program" with add icon
- [ ] Wire up navigation to ProgramBuilderScreen
- [ ] Implement activate/delete actions

### Screen 2: ProgramBuilderScreen
- [ ] Create `program_builder_screen.dart` with gradient background
- [ ] Add AppBar with title, Save button (enabled only when name not empty)
- [ ] Implement program name TextField with validation
- [ ] Create 7-day assignment list (Monday-Sunday)
- [ ] Wire up save logic (create or update)
- [ ] Handle navigation back after save

### Widgets
- [ ] Create `ProgramCard` widget
  - [ ] Program name + active badge row
  - [ ] Summary text (X days per week)
  - [ ] Overflow menu (conditional: Activate/Delete or Delete only)
  - [ ] InkWell tap to open builder
  - [ ] Card styling: 4dp elevation, 12dp radius, 16dp padding
- [ ] Create `ActiveProgramCard` widget
  - [ ] primaryContainer background
  - [ ] "Active Program" label
  - [ ] Program name (titleLarge, Bold)
  - [ ] Today's day name
  - [ ] "Start Today's Workout" button (if routine assigned) OR "Rest day"
  - [ ] 16dp padding, 16dp radius
- [ ] Create `DayAssignmentCard` widget
  - [ ] Day name (100dp width, titleMedium Bold)
  - [ ] Routine dropdown (rest day + all routines)
  - [ ] 2dp elevation, 12dp radius, 16dp padding

### State Management
- [ ] Create `weeklyProgramsProvider` with Riverpod
- [ ] Implement `createProgram` method
- [ ] Implement `updateProgram` method
- [ ] Implement `deleteProgram` method
- [ ] Implement `activateProgram` method
- [ ] Implement `deactivateAll` method (sets all isActive = false)
- [ ] Wire up callbacks (onTap, onActivate, onDelete)

### Helper Functions
- [ ] Implement `_getDayName(dayOfWeek)` (1=Monday, 7=Sunday)
- [ ] Implement today's workout detection
- [ ] Implement program summary formatting

### Styling
- [ ] Use exact gradient colors (same as all other screens)
- [ ] Use exact spacing (8dp grid: 4, 8, 16, 24, 32, 48)
- [ ] Use exact typography (headlineMedium Bold, titleLarge Bold, bodyMedium, labelSmall)
- [ ] Card: 4dp elevation, 12dp radius, 16dp padding
- [ ] Active badge: primaryContainer, 12dp radius, 8dp H padding, 4dp V padding
- [ ] NO spring animations (simpler than RoutinesTab)
- [ ] EmptyState: calendar_month icon

### Testing
- [ ] Test empty state rendering
- [ ] Test program list with 1, 5, 10+ programs
- [ ] Test active program card appears when one is active
- [ ] Test "Start Today's Workout" vs "Rest day" logic
- [ ] Test activate/deactivate (only one active at a time)
- [ ] Test program builder with 7-day dropdowns
- [ ] Test save button (enabled/disabled based on name)
- [ ] Test dropdown showing all routines + rest day option
- [ ] Run `flutter analyze` (0 errors)

### Verification
- [ ] Compare with Kotlin side-by-side (both screens)
- [ ] Verify gradient backgrounds match exactly
- [ ] Verify card styling matches (elevation, radius, padding)
- [ ] Verify active badge styling matches
- [ ] Verify overflow menu matches (conditional items)
- [ ] Verify today's workout detection works correctly
- [ ] Verify day mapping (1-7) matches Kotlin

---

## Expected Outcome

After implementation:

**WeeklyProgramsScreen:**
1. ✅ Renders with gradient background
2. ✅ Empty state shown when no programs exist
3. ✅ Active program card shown at top when one is active
4. ✅ "Start Today's Workout" button appears when today has routine
5. ✅ "Rest day" message appears when today has no routine
6. ✅ Program list shown with proper cards
7. ✅ Activate action sets program as active (deactivates others)
8. ✅ Delete action removes program
9. ✅ FAB creates new program (navigates to builder)
10. ✅ Card tap opens builder for editing

**ProgramBuilderScreen:**
11. ✅ Renders with gradient background and AppBar
12. ✅ Program name TextField with validation
13. ✅ Save button disabled when name empty
14. ✅ 7 day assignment cards (Monday-Sunday)
15. ✅ Each day has dropdown (rest day + all routines)
16. ✅ Save creates or updates program
17. ✅ Navigates back after save

**Overall:**
18. ✅ `flutter analyze`: 0 errors
19. ✅ Pixel-perfect match to Kotlin
20. ✅ Day mapping works correctly (1-7)
21. ✅ Only one active program at a time
22. ✅ Today's workout detection accurate
