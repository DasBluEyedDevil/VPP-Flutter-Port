# Settings Tab - Flutter Implementation Brief (Screen 8/16)

**Source Analysis:** SETTINGS_TAB_ANALYSIS.md (700+ lines)
**Target:** Exact 1:1 match with Kotlin SettingsScreen.kt

## Implementation Tasks

### 1. Create 8 New Widgets

**lib/presentation/screens/settings_tab.dart** (ConsumerStatefulWidget)
- TopAppBar: "Settings" title
- 6 card sections (see analysis for full specs)
- DataStore reactive state (ref.watch)
- Confirmation dialog for destructive actions

**lib/presentation/widgets/settings/settings_section_card.dart**
- Reusable card container
- 16dp radius, 4dp elevation, 1dp border (#F5F3FF)
- 16dp padding

**lib/presentation/widgets/settings/settings_section_header.dart**
- GradientIconBox (64x64dp) + title
- 6 unique gradients (see analysis)
- titleLarge Bold typography

**lib/presentation/widgets/settings/gradient_icon_box.dart**
- Generic gradient background container
- 64x64dp size
- 16dp radius
- LinearGradient with colors list

**lib/presentation/widgets/settings/setting_switch_row.dart**
- Label (titleMedium) + description (bodySmall)
- Switch on right side
- 48dp touch target height
- Optimistic UI pattern

**lib/presentation/widgets/settings/weight_unit_selector.dart**
- FilterChip-style toggle (KG/LB)
- Selected: primary color, white text
- Unselected: surfaceContainerHighest, onSurface text
- Optimistic UI with BLE update

**lib/presentation/widgets/settings/color_scheme_list.dart**
- 7 color scheme buttons (Blue, Green, Teal, Yellow, Pink, Red, Purple)
- Each: 48dp height, full width, 12dp radius
- Selected: gradient background
- Unselected: surfaceContainerHighest

**lib/presentation/widgets/dialogs/delete_confirmation_dialog.dart**
- AlertDialog
- Title: "Delete All Workouts?"
- Message: "This will permanently delete all workout history. This cannot be undone."
- Actions: "Cancel" (TextButton), "Delete" (FilledButton, error color)

### 2. Update Providers

**lib/presentation/providers/user_preferences_provider.dart**
- Add StateNotifierProvider for user preferences
- Reactive to DataStore changes
- Methods: updateWeightUnit, updateAutoplay, updateStopAtTop, updateVideoPlayback

**lib/data/repositories/user_preferences_repository.dart**
- DataStore integration (or SharedPreferences)
- Keys: "weight_unit", "autoplay_enabled", "stop_at_top", "enable_video_playback"
- Stream-based reactive updates

### 3. Critical Requirements

**Exact Measurements** (from analysis):
- Spacing: 8dp grid (4, 8, 16, 24, 32, 48)
- Card radius: 16dp, elevation: 4dp
- Icon box: 64x64dp gradient
- Switch row: 48dp height minimum

**6 Gradient Schemes** (LinearGradient):
1. Weight Unit: [#8B5CF6, #9333EA]
2. Workout Preferences: [#6366F1, #8B5CF6]
3. LED Color: [#3B82F6, #6366F1]
4. Data Management: [#F97316, #EF4444]
5. Developer Tools: [#F59E0B, #EF4444]
6. App Info: [#22C55E, #3B82F6]

**Optimistic UI Pattern**:
- Update UI immediately on user action
- Persist to DataStore in background
- No loading spinners for settings changes

**Delete Confirmation Flow**:
1. User taps "Delete All Workouts"
2. Show DeleteConfirmationDialog
3. User confirms â†’ Call repository.deleteAllWorkouts()
4. Show SnackBar: "All workouts deleted"

### 4. Testing Requirements

After implementation:
1. Run `flutter analyze` - must pass
2. Check all 15 settings are present
3. Verify gradients match exactly
4. Test theme switching (if added)
5. Test delete confirmation flow
6. Verify DataStore persistence

### 5. Files to Create/Update

**NEW:**
- lib/presentation/screens/settings_tab.dart
- lib/presentation/widgets/settings/settings_section_card.dart
- lib/presentation/widgets/settings/settings_section_header.dart
- lib/presentation/widgets/settings/gradient_icon_box.dart
- lib/presentation/widgets/settings/setting_switch_row.dart
- lib/presentation/widgets/settings/weight_unit_selector.dart
- lib/presentation/widgets/settings/color_scheme_list.dart
- lib/presentation/widgets/dialogs/delete_confirmation_dialog.dart

**UPDATE:**
- lib/presentation/providers/user_preferences_provider.dart
- lib/data/repositories/user_preferences_repository.dart

See SETTINGS_TAB_ANALYSIS.md for complete specifications.
