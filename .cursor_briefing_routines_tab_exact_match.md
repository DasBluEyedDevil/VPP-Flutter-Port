# Routines Tab - Exact Kotlin Match

**Task:** Implement Flutter RoutinesTab to exactly match Kotlin RoutinesTab.kt

**Source Analysis:** ROUTINES_TAB_ANALYSIS.md (comprehensive 5,700+ line analysis)

## Current Flutter Implementation Status

### ✅ Likely Already Exist (Verify):
- Domain models: `Routine`, `Exercise` (check lib/domain/models/)
- Repositories: `ExerciseRepository`, `PersonalRecordRepository` (check lib/data/)
- Providers: Riverpod state management setup

### ❌ Missing or Needs Update:
- `lib/presentation/screens/routines_tab.dart` - Main screen (may exist but likely incomplete)
- `lib/presentation/widgets/workout/routine_card.dart` - Routine card widget (NEW)
- `lib/presentation/widgets/common/empty_state.dart` - Reusable empty state (check if exists)
- Helper functions: `formatSetReps`, `formatEstimatedDuration`, smart duplicate logic

---

## 1. Main Screen: RoutinesTab

**File:** `lib/presentation/screens/routines_tab.dart` (UPDATE or CREATE)

### Widget Structure

```dart
class RoutinesTab extends ConsumerWidget {
  const RoutinesTab({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final routines = ref.watch(routinesProvider);  // List<Routine>
    final theme = Theme.of(context);
    final isDark = theme.brightness == Brightness.dark;

    return Container(
      decoration: BoxDecoration(
        gradient: LinearGradient(
          begin: Alignment.topCenter,
          end: Alignment.bottomCenter,
          colors: isDark
            ? [
                const Color(0xFF0F172A), // slate-900
                const Color(0xFF1E1B4B), // indigo-950
                const Color(0xFF172554), // blue-950
              ]
            : [
                const Color(0xFFE0E7FF), // indigo-200
                const Color(0xFFFCE7F3), // pink-100
                const Color(0xFFDDD6FE), // violet-200
              ],
        ),
      ),
      child: Scaffold(
        backgroundColor: Colors.transparent,
        body: routines.isEmpty
            ? EmptyState(
                icon: Icons.fitness_center,
                title: 'No routines yet',
                message: 'Create your first workout routine to get started',
                actionLabel: 'Create Routine',
                onAction: () => _showRoutineBuilder(context, ref),
              )
            : Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  // Header
                  Padding(
                    padding: const EdgeInsets.all(20.0),
                    child: Text(
                      'My Routines',
                      style: theme.textTheme.headlineMedium?.copyWith(
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                  ),
                  // Routine List
                  Expanded(
                    child: ListView.separated(
                      padding: const EdgeInsets.only(bottom: 88), // FAB clearance
                      itemCount: routines.length,
                      separatorBuilder: (_, __) => const SizedBox(height: 8),
                      itemBuilder: (context, index) {
                        return RoutineCard(
                          routine: routines[index],
                          onTap: () => _startWorkout(context, ref, routines[index]),
                          onEdit: () => _editRoutine(context, ref, routines[index]),
                          onDuplicate: () => _duplicateRoutine(ref, routines[index], routines),
                          onDelete: () => _deleteRoutine(ref, routines[index]),
                        );
                      },
                    ),
                  ),
                ],
              ),
        floatingActionButton: FloatingActionButton.extended(
          onPressed: () => _showRoutineBuilder(context, ref),
          icon: const Icon(Icons.add),
          label: const Text('Create Routine'),
        ),
      ),
    );
  }
}
```

### Helper Methods (in RoutinesTab or separate file)

```dart
void _startWorkout(BuildContext context, WidgetRef ref, Routine routine) {
  // Navigate to ActiveWorkoutScreen with routine
  // TODO: Implement navigation
}

void _editRoutine(BuildContext context, WidgetRef ref, Routine routine) {
  // Show RoutineBuilderDialog with existing routine
  // TODO: Implement dialog (defer to later)
}

void _duplicateRoutine(WidgetRef ref, Routine routine, List<Routine> allRoutines) {
  // Smart duplicate with "(Copy N)" naming
  final duplicate = _createSmartDuplicate(routine, allRoutines);
  ref.read(routinesProvider.notifier).addRoutine(duplicate);
}

void _deleteRoutine(WidgetRef ref, Routine routine) {
  ref.read(routinesProvider.notifier).deleteRoutine(routine.id);
}

void _showRoutineBuilder(BuildContext context, WidgetRef ref) {
  // Show RoutineBuilderDialog for new routine
  // TODO: Implement dialog (defer to later)
}

Routine _createSmartDuplicate(Routine original, List<Routine> existingRoutines) {
  // Extract base name and find highest (Copy N)
  final baseName = _extractBaseName(original.name);
  final nextCopyNumber = _findNextCopyNumber(baseName, existingRoutines);

  final newName = nextCopyNumber == 1
      ? '$baseName (Copy)'
      : '$baseName (Copy $nextCopyNumber)';

  return Routine(
    id: Uuid().v4(),  // New UUID
    name: newName,
    description: original.description,
    exercises: original.exercises.map((e) => Exercise(
      id: Uuid().v4(),  // New UUID for each exercise
      exerciseId: e.exerciseId,
      sets: e.sets,
      reps: e.reps,
      // ... copy all other fields
    )).toList(),
  );
}

String _extractBaseName(String name) {
  // Regex: remove " (Copy)" or " (Copy N)" suffix
  final copyPattern = RegExp(r'\s*\(Copy\s*\d*\)\s*$');
  return name.replaceAll(copyPattern, '').trim();
}

int _findNextCopyNumber(String baseName, List<Routine> routines) {
  final copyPattern = RegExp(r'\(Copy\s*(\d*)\)$');
  final copyNumbers = <int>[0];  // Start with 0 (base case: first copy)

  for (final routine in routines) {
    if (routine.name.startsWith(baseName)) {
      final match = copyPattern.firstMatch(routine.name);
      if (match != null) {
        final numberStr = match.group(1);
        final number = numberStr?.isEmpty == true ? 1 : int.tryParse(numberStr!) ?? 1;
        copyNumbers.add(number);
      }
    }
  }

  return copyNumbers.reduce(max) + 1;
}
```

### Styling Constants

| Element | Value |
|---------|-------|
| Screen horizontal padding | 20dp |
| Header bottom margin | 20dp |
| List item spacing | 8dp |
| FAB bottom clearance | 88dp |

---

## 2. RoutineCard Widget

**File:** `lib/presentation/widgets/workout/routine_card.dart` (NEW)

### Complete Implementation

```dart
class RoutineCard extends StatefulWidget {
  final Routine routine;
  final VoidCallback onTap;
  final VoidCallback onEdit;
  final VoidCallback onDuplicate;
  final VoidCallback onDelete;

  const RoutineCard({
    super.key,
    required this.routine,
    required this.onTap,
    required this.onEdit,
    required this.onDuplicate,
    required this.onDelete,
  });

  @override
  State<RoutineCard> createState() => _RoutineCardState();
}

class _RoutineCardState extends State<RoutineCard>
    with SingleTickerProviderStateMixin {
  late AnimationController _animationController;
  late Animation<double> _scaleAnimation;
  bool _showMenu = false;

  @override
  void initState() {
    super.initState();
    _animationController = AnimationController(
      vsync: this,
      duration: const Duration(milliseconds: 100),
    );
    _scaleAnimation = Tween<double>(begin: 1.0, end: 0.99).animate(
      CurvedAnimation(
        parent: _animationController,
        curve: Curves.easeInOut,
      ),
    );
  }

  @override
  void dispose() {
    _animationController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);

    return Padding(
      padding: const EdgeInsets.symmetric(horizontal: 20),
      child: GestureDetector(
        onTapDown: (_) => _animationController.forward(),
        onTapUp: (_) {
          _animationController.reverse();
          widget.onTap();
        },
        onTapCancel: () => _animationController.reverse(),
        child: ScaleTransition(
          scale: _scaleAnimation,
          child: Card(
            elevation: 4,
            surfaceTintColor: Colors.transparent,
            shape: RoundedCornerShape(12),
            child: Container(
              decoration: BoxDecoration(
                border: Border.all(
                  color: const Color(0xFFF5F3FF),  // purple-50
                  width: 1,
                ),
                borderRadius: BorderRadius.circular(12),
              ),
              child: Padding(
                padding: const EdgeInsets.all(16),
                child: Row(
                  children: [
                    // Gradient Icon Box
                    Container(
                      width: 64,
                      height: 64,
                      decoration: BoxDecoration(
                        gradient: const LinearGradient(
                          begin: Alignment.topLeft,
                          end: Alignment.bottomRight,
                          colors: [
                            Color(0xFF9333EA),  // purple-500
                            Color(0xFF7E22CE),  // purple-700
                          ],
                        ),
                        borderRadius: BorderRadius.circular(12),
                        boxShadow: [
                          BoxShadow(
                            color: const Color(0xFF9333EA).withOpacity(0.3),
                            blurRadius: 8,
                            offset: const Offset(0, 4),
                          ),
                        ],
                      ),
                      child: const Icon(
                        Icons.fitness_center,
                        size: 32,
                        color: Colors.white,
                      ),
                    ),

                    const SizedBox(width: 16),

                    // Content Column
                    Expanded(
                      child: Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          // Routine Name
                          Text(
                            widget.routine.name,
                            style: theme.textTheme.titleLarge?.copyWith(
                              fontWeight: FontWeight.bold,
                            ),
                            maxLines: 1,
                            overflow: TextOverflow.ellipsis,
                          ),

                          const SizedBox(height: 4),

                          // Description or exercise count
                          Text(
                            widget.routine.description.isEmpty
                                ? '${widget.routine.exercises.length} exercises'
                                : widget.routine.description,
                            style: theme.textTheme.bodyMedium?.copyWith(
                              color: theme.colorScheme.onSurfaceVariant,
                            ),
                            maxLines: 1,
                            overflow: TextOverflow.ellipsis,
                          ),

                          const SizedBox(height: 8),

                          // Metadata Row
                          Row(
                            children: [
                              // Sets indicator
                              Icon(
                                Icons.numbers,
                                size: 16,
                                color: theme.colorScheme.onSurfaceVariant,
                              ),
                              const SizedBox(width: 4),
                              Text(
                                _formatAllSetsReps(widget.routine.exercises),
                                style: theme.textTheme.bodySmall?.copyWith(
                                  color: theme.colorScheme.onSurfaceVariant,
                                ),
                              ),

                              const SizedBox(width: 16),

                              // Duration indicator
                              Icon(
                                Icons.schedule,
                                size: 16,
                                color: theme.colorScheme.onSurfaceVariant,
                              ),
                              const SizedBox(width: 4),
                              Text(
                                _formatEstimatedDuration(widget.routine.exercises),
                                style: theme.textTheme.bodySmall?.copyWith(
                                  color: theme.colorScheme.onSurfaceVariant,
                                ),
                              ),
                            ],
                          ),

                          const SizedBox(height: 8),

                          // Exercise Preview
                          Text(
                            _formatExercisePreview(widget.routine.exercises),
                            style: theme.textTheme.bodySmall?.copyWith(
                              color: theme.colorScheme.primary,
                              fontWeight: FontWeight.w500,
                            ),
                            maxLines: 1,
                            overflow: TextOverflow.ellipsis,
                          ),
                        ],
                      ),
                    ),

                    const SizedBox(width: 8),

                    // Overflow Menu Button
                    PopupMenuButton<String>(
                      icon: const Icon(Icons.more_vert),
                      onSelected: (value) {
                        switch (value) {
                          case 'edit':
                            widget.onEdit();
                            break;
                          case 'duplicate':
                            widget.onDuplicate();
                            break;
                          case 'delete':
                            widget.onDelete();
                            break;
                        }
                      },
                      itemBuilder: (context) => [
                        const PopupMenuItem(
                          value: 'edit',
                          child: Row(
                            children: [
                              Icon(Icons.edit, size: 20),
                              SizedBox(width: 12),
                              Text('Edit'),
                            ],
                          ),
                        ),
                        const PopupMenuItem(
                          value: 'duplicate',
                          child: Row(
                            children: [
                              Icon(Icons.content_copy, size: 20),
                              SizedBox(width: 12),
                              Text('Duplicate'),
                            ],
                          ),
                        ),
                        const PopupMenuItem(
                          value: 'delete',
                          child: Row(
                            children: [
                              Icon(Icons.delete, size: 20),
                              SizedBox(width: 12),
                              Text('Delete'),
                            ],
                          ),
                        ),
                      ],
                    ),
                  ],
                ),
              ),
            ),
          ),
        ),
      ),
    );
  }

  String _formatAllSetsReps(List<Exercise> exercises) {
    if (exercises.isEmpty) return '0 sets';

    // Group all reps across all exercises
    final allReps = exercises.expand((e) => e.reps).toList();
    return _formatSetReps(allReps);
  }

  String _formatSetReps(List<int> reps) {
    if (reps.isEmpty) return '0 sets';

    final groups = <String>[];
    int count = 1;
    int? currentRep = reps.first;

    for (int i = 1; i < reps.length; i++) {
      if (reps[i] == currentRep) {
        count++;
      } else {
        groups.add('$count×$currentRep');
        currentRep = reps[i];
        count = 1;
      }
    }
    groups.add('$count×$currentRep');

    return groups.join(', ');
  }

  String _formatEstimatedDuration(List<Exercise> exercises) {
    if (exercises.isEmpty) return '0 min';

    int totalSeconds = 0;
    for (final exercise in exercises) {
      final reps = exercise.reps.reduce((a, b) => a + b);
      totalSeconds += reps * 3;  // 3 seconds per rep
      totalSeconds += exercise.sets * (exercise.restTime ?? 90);  // rest between sets
    }

    final minutes = totalSeconds ~/ 60;
    if (minutes < 60) {
      return '$minutes min';
    } else {
      final hours = minutes ~/ 60;
      final remainingMinutes = minutes % 60;
      return remainingMinutes > 0 ? '${hours}h ${remainingMinutes}m' : '${hours}h';
    }
  }

  String _formatExercisePreview(List<Exercise> exercises) {
    if (exercises.isEmpty) return 'No exercises';

    final preview = exercises.take(4).map((e) => e.exerciseId).join(', ');
    final remaining = exercises.length - 4;

    return remaining > 0 ? '$preview, + $remaining more' : preview;
  }
}
```

### Card Styling Details

| Element | Value |
|---------|-------|
| Card elevation | 4dp |
| Card border radius | 12dp |
| Card border color | #F5F3FF (purple-50) |
| Card border width | 1dp |
| Card padding | 16dp |
| Horizontal screen margin | 20dp |
| Icon box size | 64dp × 64dp |
| Icon box gradient | #9333EA → #7E22CE |
| Icon box border radius | 12dp |
| Icon box shadow | 4dp offset, 8dp blur, 30% opacity |
| Icon size | 32dp |
| Icon color | White |
| Content spacing | 16dp (icon to content) |
| Metadata icon size | 16dp |
| Press animation scale | 1.0 → 0.99 |
| Press animation duration | 100ms |
| Press animation curve | easeInOut |

---

## 3. EmptyState Widget

**File:** `lib/presentation/widgets/common/empty_state.dart` (CREATE if not exists)

### Implementation

```dart
class EmptyState extends StatelessWidget {
  final IconData icon;
  final String title;
  final String message;
  final String? actionLabel;
  final VoidCallback? onAction;

  const EmptyState({
    super.key,
    required this.icon,
    required this.title,
    required this.message,
    this.actionLabel,
    this.onAction,
  });

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);

    return Center(
      child: Padding(
        padding: const EdgeInsets.all(32),
        child: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            // Icon
            Icon(
              icon,
              size: 64,
              color: theme.colorScheme.onSurfaceVariant.withOpacity(0.6),
            ),

            const SizedBox(height: 24),

            // Title
            Text(
              title,
              style: theme.textTheme.titleLarge?.copyWith(
                fontWeight: FontWeight.bold,
              ),
              textAlign: TextAlign.center,
            ),

            const SizedBox(height: 8),

            // Message
            Text(
              message,
              style: theme.textTheme.bodyMedium?.copyWith(
                color: theme.colorScheme.onSurfaceVariant,
              ),
              textAlign: TextAlign.center,
            ),

            if (actionLabel != null && onAction != null) ...[
              const SizedBox(height: 24),
              FilledButton.icon(
                onPressed: onAction,
                icon: const Icon(Icons.add),
                label: Text(actionLabel!),
              ),
            ],
          ],
        ),
      ),
    );
  }
}
```

### EmptyState Styling

| Element | Value |
|---------|-------|
| Container padding | 32dp |
| Icon size | 64dp |
| Icon opacity | 60% of onSurfaceVariant |
| Icon to title spacing | 24dp |
| Title to message spacing | 8dp |
| Message to button spacing | 24dp |
| Title style | titleLarge, Bold |
| Message style | bodyMedium, onSurfaceVariant |

---

## 4. Integration Requirements

### Providers Needed

```dart
// lib/presentation/providers/routines_provider.dart
@riverpod
class Routines extends _$Routines {
  @override
  Future<List<Routine>> build() async {
    final repo = ref.watch(routineRepositoryProvider);
    return repo.getAllRoutines();
  }

  Future<void> addRoutine(Routine routine) async {
    final repo = ref.read(routineRepositoryProvider);
    await repo.insertRoutine(routine);
    ref.invalidateSelf();
  }

  Future<void> updateRoutine(Routine routine) async {
    final repo = ref.read(routineRepositoryProvider);
    await repo.updateRoutine(routine);
    ref.invalidateSelf();
  }

  Future<void> deleteRoutine(String id) async {
    final repo = ref.read(routineRepositoryProvider);
    await repo.deleteRoutine(id);
    ref.invalidateSelf();
  }
}
```

### Dependencies

- `uuid` package for generating UUIDs
- Domain models: `Routine`, `Exercise`
- Repository: `RoutineRepository`
- Material 3 theme with proper colorScheme

---

## 5. Critical Implementation Notes

### 1. Smart Duplicate Algorithm
- **MUST** use regex to extract base name
- **MUST** find highest existing (Copy N) number
- **MUST** generate new UUIDs for routine + all exercises
- **MUST** preserve all other properties exactly

### 2. Set/Rep Formatting
- **MUST** group consecutive identical rep values
- Format: `"3×10, 2×8"` (multiplication sign: ×, not x)
- Handle edge cases: empty lists, single rep, all different

### 3. Duration Estimation
- Formula: `totalReps × 3 seconds + (sets × restTime)`
- Format: Under 60 min → `"X min"`, Over 60 min → `"Xh Ym"`
- Default rest time: 90 seconds if not specified

### 4. Exercise Preview
- Show first 4 exercise IDs (comma-separated)
- If more than 4: append `", + X more"`
- If empty: `"No exercises"`

### 5. Spring Press Animation
- Scale: `1.0 → 0.99` (subtle)
- Duration: `100ms`
- Curve: `easeInOut`
- Trigger: `onTapDown`, reverse: `onTapUp` and `onTapCancel`

### 6. Gradient Backgrounds
- **MUST** be conditional on theme brightness
- Dark mode: slate/indigo/blue gradient
- Light mode: lavender/pink/violet gradient
- Use exact hex codes from analysis

### 7. Card Styling
- **MUST** have 1dp purple-50 border
- **MUST** have 4dp elevation
- **MUST** disable surface tint (`surfaceTintColor: Colors.transparent`)
- 12dp corner radius

### 8. Icon Box Shadow
- Color: purple-500 (#9333EA) @ 30% opacity
- Blur: 8dp
- Offset: (0, 4dp)

### 9. Overflow Menu
- Use `PopupMenuButton` (Material 3)
- 3 items: Edit (edit icon), Duplicate (content_copy icon), Delete (delete icon)
- Icon size: 20dp
- Icon to text spacing: 12dp

### 10. Empty State
- **MUST** be reusable component (can be used in other tabs)
- Icon size: 64dp
- Icon opacity: 60%
- CTA button: `FilledButton.icon` with add icon

---

## 6. Implementation Checklist

### Domain & Data
- [ ] Verify `Routine` model exists with all required fields
- [ ] Verify `Exercise` model exists with all required fields
- [ ] Verify `RoutineRepository` exists with CRUD methods
- [ ] Add `uuid` package to dependencies if not present

### Widgets
- [ ] Create or update `routines_tab.dart` with gradient background
- [ ] Implement conditional rendering (empty state vs list)
- [ ] Add screen header with proper padding and style
- [ ] Create `RoutineCard` widget with all elements
- [ ] Implement 64dp gradient icon box with shadow
- [ ] Add content column with name, description, metadata, preview
- [ ] Implement overflow menu with 3 options
- [ ] Add spring press animation (scale 0.99, 100ms)
- [ ] Create `EmptyState` widget (if doesn't exist)
- [ ] Add FloatingActionButton with "Create Routine" label

### Helper Functions
- [ ] Implement `formatSetReps` (group consecutive reps)
- [ ] Implement `formatEstimatedDuration` (3 sec/rep + rest)
- [ ] Implement `formatExercisePreview` (first 4 + remainder)
- [ ] Implement smart duplicate logic with regex
- [ ] Implement `extractBaseName` (remove (Copy N) suffix)
- [ ] Implement `findNextCopyNumber` (find highest existing)

### State Management
- [ ] Create `routinesProvider` with Riverpod
- [ ] Implement `addRoutine` method
- [ ] Implement `updateRoutine` method
- [ ] Implement `deleteRoutine` method
- [ ] Wire up callbacks (onTap, onEdit, onDuplicate, onDelete)

### Styling
- [ ] Use exact gradient colors (dark: slate/indigo/blue, light: lavender/pink/violet)
- [ ] Use exact spacing (8dp grid: 4, 8, 16, 24, 32, 48)
- [ ] Use exact typography (headlineMedium Bold, titleLarge Bold, bodyMedium, bodySmall)
- [ ] Use exact colors (purple gradient: #9333EA → #7E22CE, border: #F5F3FF)
- [ ] Card: 4dp elevation, 12dp radius, 1dp border, 16dp padding
- [ ] Icon box: 64dp, 12dp radius, 4dp shadow, 32dp icon
- [ ] EmptyState: 64dp icon @ 60% opacity, 32dp padding

### Testing
- [ ] Test empty state rendering
- [ ] Test routine list rendering with 1, 5, 10+ routines
- [ ] Test card tap (should trigger onTap)
- [ ] Test press animation (scale to 0.99)
- [ ] Test overflow menu (Edit, Duplicate, Delete)
- [ ] Test smart duplicate naming ("Workout" → "Workout (Copy)" → "Workout (Copy 2)")
- [ ] Test set/rep formatting (consecutive grouping)
- [ ] Test duration estimation (under 60 min, over 60 min)
- [ ] Test exercise preview (4 exercises, 5+ exercises)
- [ ] Run `flutter analyze` (0 errors)

### Verification
- [ ] Compare with Kotlin side-by-side (colors, spacing, typography)
- [ ] Verify gradient backgrounds match exactly
- [ ] Verify card styling matches (border, shadow, elevation)
- [ ] Verify press animation feels right (subtle, quick)
- [ ] Verify overflow menu positioning and items
- [ ] Verify empty state matches Kotlin

---

## 7. Deferred Work (Not in This Task)

The following are mentioned in the analysis but should be implemented separately:

- **RoutineBuilderDialog** - Complex full-screen dialog for creating/editing routines
  - Will require its own analysis and implementation task
  - Depends on ExercisePicker dialog
  - Complex form validation and state management

- **Navigation to ActiveWorkoutScreen** - Requires routing setup
  - Pass selected routine to workout screen
  - Handle workout initialization

For now, these can be stub implementations:
```dart
void _showRoutineBuilder(BuildContext context, WidgetRef ref, [Routine? routine]) {
  // TODO: Implement RoutineBuilderDialog (separate task)
  ScaffoldMessenger.of(context).showSnackBar(
    const SnackBar(content: Text('Routine builder not implemented yet')),
  );
}

void _startWorkout(BuildContext context, WidgetRef ref, Routine routine) {
  // TODO: Implement navigation to ActiveWorkoutScreen (separate task)
  ScaffoldMessenger.of(context).showSnackBar(
    SnackBar(content: Text('Starting workout: ${routine.name}')),
  );
}
```

---

## 8. Expected Outcome

After implementation:

1. ✅ Routines Tab screen renders with gradient background
2. ✅ Empty state shown when no routines exist
3. ✅ Routine list shown with proper cards when routines exist
4. ✅ Each card has gradient icon, name, description, metadata, preview
5. ✅ Cards have spring press animation
6. ✅ Overflow menu works (Edit, Duplicate, Delete)
7. ✅ Smart duplicate creates properly named copies
8. ✅ Set/rep formatting groups consecutive values
9. ✅ Duration estimation calculates correctly
10. ✅ Exercise preview shows first 4 + remainder
11. ✅ FAB creates new routine (stub for now)
12. ✅ Card tap starts workout (stub for now)
13. ✅ `flutter analyze`: 0 errors
14. ✅ Pixel-perfect match to Kotlin RoutinesTab

### Visual Match Verification

**Gradient Background:**
- Dark mode: Smooth gradient from slate-900 → indigo-950 → blue-950
- Light mode: Smooth gradient from indigo-200 → pink-100 → violet-200

**Routine Card:**
- 64dp gradient icon box (purple-500 → purple-700) with shadow
- 32dp white FitnessCenter icon
- Name: titleLarge, Bold
- Description/exercise count: bodyMedium, onSurfaceVariant
- Metadata row: 16dp icons, bodySmall text
- Exercise preview: bodySmall, primary color, Medium weight
- Overflow menu: top-right, 3 items with icons

**Empty State:**
- 64dp fitness_center icon @ 60% opacity
- Title: titleLarge, Bold
- Message: bodyMedium, onSurfaceVariant
- CTA: FilledButton.icon "Create Routine"

**Spacing:**
- Screen padding: 20dp
- List spacing: 8dp
- Card padding: 16dp
- Content gaps: 4dp, 8dp, 16dp (exact match to Kotlin)
